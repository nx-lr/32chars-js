"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_taggedTemplateLiteral2=_interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral")),_voca=_interopRequireDefault(require("voca")),_lodash=_interopRequireDefault(require("lodash")),_fs=_interopRequireDefault(require("fs")),_isValidIdentifier=_interopRequireDefault(require("is-valid-identifier")),_jsesc=_interopRequireDefault(require("jsesc")),_xregexp=_interopRequireDefault(require("xregexp")),_templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17;function ownKeys(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _createForOfIteratorHelper(e,t){var r,a,n,c,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(o)return a=!(r=!0),{s:function(){o=o.call(e)},n:function(){var e=o.next();return r=e.done,e},e:function(e){a=!0,n=e},f:function(){try{r||null==o.return||o.return()}finally{if(a)throw n}}};if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),c=0,{s:t=function(){},n:function(){return c>=e.length?{done:!0}:{done:!1,value:e[c++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var print=console.log,text=_fs.default.readFileSync("./input.txt","utf8");function encodeText(TEXT,GLOBAL_VAR){var _TEXT$match,_ref25,_ref26,_ref=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},_ref$STRICT_MODE=_ref.STRICT_MODE,STRICT_MODE=void 0!==_ref$STRICT_MODE&&_ref$STRICT_MODE,_ref$QUOTE_STYLE=_ref.QUOTE_STYLE,QUOTE_STYLE=void 0===_ref$QUOTE_STYLE?"":_ref$QUOTE_STYLE,BUILTINS=RegExp("^\\b("+["module","exports","Infinity","NaN","undefined","globalThis","this","eval","isFinite","isNaN","parseFloat","parseInt","encodeURI","encodeURIComponent","decodeURI","decodeURIComponent","escape","unescape","Object","Function","Boolean","Symbol","Number","BigInt","Math","Date","String","RegExp","Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Reflect","Proxy","Intl","WebAssembly"].sort().join(_templateObject=_templateObject||(0,_taggedTemplateLiteral2.default)(["|"]))+")\\b$"),REGEXPS={constant:/\b(true|false|Infinity|NaN|undefined)\b/g,constructor:/\b(Array|Object|String|Number|Boolean|RegExp|Function)\b/g,word:(0,_xregexp.default)(String.raw(_templateObject2=_templateObject2||(0,_taggedTemplateLiteral2.default)(["([GHJ-MPQTV-Z]|[pLpN]{2,})"],["([GHJ-MPQTV-Z]|[\\pL\\pN]{2,})"])),"g"),letter:/\b[\da-zA-FINORSU]\b/g,symbol:/[!"#$%&'()*+,\-./:;<=>?@\[\\\]^_`{|}~]+/g,unicode:/[^!"#$%&'()*+,\-./:;<=>?@\[\\\]^_`{|}~ ]+/g},REGEXP=Object.entries(REGEXPS).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=e[1].source;return"(?<".concat(t,">").concat(e,")")}).join(_templateObject3=_templateObject3||(0,_taggedTemplateLiteral2.default)(["|"])),REGEXP=RegExp(REGEXP,"g"),checkIdentifier=function(e){return(e=e.trim())&&(0,_isValidIdentifier.default)(e)&&!BUILTINS.test(e)};if(!checkIdentifier(GLOBAL_VAR))throw new Error("Invalid global variable: ".concat(quote(GLOBAL_VAR)));var MAX_STRING_LENGTH=536870888,enUS=Intl.NumberFormat("en-us");if(TEXT.length>MAX_STRING_LENGTH)throw new Error("Input string can only be up to ".concat(enUS.format(NODE_MAX_LENGTH)," characters long"));for(var count=0,quote=function(e){var t=(null==(t=e.match(/'/g))?void 0:t.length)||0,r=(null==(r=e.match(/"/g))?void 0:r.length)||0,a=(/\$\{|`/.test(e)||/['"]/.test(e),/\b(single|double)\b/i.test(QUOTE_STYLE)),a=a&&/\bbonly\b/i.test(QUOTE_STYLE)?QUOTE_STYLE.match(/\b(single|double)\b/i)[0].toLowerCase():/\bcycle\b/i.test(QUOTE_STYLE)?(/\bsingle\b/i.test(QUOTE_STYLE)?["single","double"]:["double","single"])[count++%2]:a?t<r?"single":r<t?"double":QUOTE_STYLE.toLowerCase().trim():.5<Math.random()?"double":"single";return(0,_jsesc.default)(e,{quotes:a,wrap:!0})},LETTERS="abcdefghijklmnopqrstuvwxyz",CIPHER=";.!:_-,?/'*+#%&^\"|~$=<>`@\\",SPACE="-",encodeLetter=function(e){return(_voca.default.isUpperCase(e)?"$":"_")+(e=e.toLowerCase(),CIPHER[LETTERS.indexOf(e)])},encodeDigit=function(e){return(0,_toConsumableArray2.default)((+e).toString(2).padStart(3,0)).map(function(e){return 1==e?"$":"_"}).join(_templateObject4=_templateObject4||(0,_taggedTemplateLiteral2.default)([""]))},CONSTANTS={true:"!".concat(quote("")),false:"![]",undefined:"[][[]]",Infinity:"!".concat(quote(""),"/![]"),NaN:"+{}","[object Object]":"{}"},RESULT="".concat(STRICT_MODE?"var _".concat(GLOBAL_VAR,","):"").concat(GLOBAL_VAR,"=~[];"),CHARSET_1={},_i=0,_Object$entries=Object.entries(CONSTANTS);_i<_Object$entries.length;_i++){var _Object$entries$_i=(0,_slicedToArray2.default)(_Object$entries[_i],2),constant=_Object$entries$_i[0],expression=_Object$entries$_i[1],_iterator=_createForOfIteratorHelper(constant),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _char2=_step.value;!/[\w\s]/.test(_char2)||_char2 in CHARSET_1||(CHARSET_1[_char2]=[expression,constant.indexOf(_char2)])}}catch(err){_iterator.e(err)}finally{_iterator.f()}}for(var RES_CHARSET_1=(GLOBAL_VAR+"={"+_lodash.default.range(0,10).map(function(t){return["".concat(encodeDigit(t),":`${++").concat(GLOBAL_VAR,"}`"),Object.entries(CHARSET_1).filter(function(e){e=(0,_slicedToArray2.default)(e,2);return(0,_slicedToArray2.default)(e[1],2)[1]==t}).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=(0,_slicedToArray2.default)(e[1],1)[0],t=quote(encodeLetter(t));return"".concat(t,":`${").concat(e,"}`[").concat(GLOBAL_VAR,"]")})]}).flat().join(_templateObject5=_templateObject5||(0,_taggedTemplateLiteral2.default)([","])).replace(/,$/,"").replace(/,+/g,",")+"}").replace("_undefined",SPACE),IDENT_SET1=(RESULT+=RES_CHARSET_1,{concat:"+",call:"!",join:"%",slice:"/",return:"_",constructor:"$"}),CONSTRUCTORS={Array:"[]",Object:"{}",String:quote(""),Number:"(~[])",Boolean:"(![])",RegExp:"/./",Function:"(()=>{})"},CHARSET_2=_objectSpread({},CHARSET_1),_i2=0,_Object$entries2=Object.entries(CONSTRUCTORS);_i2<_Object$entries2.length;_i2++){var _Object$entries2$_i=(0,_slicedToArray2.default)(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],_expression=_Object$entries2$_i[1],index=void 0,_constructor=eval(key).toString(),_iterator2=_createForOfIteratorHelper(_constructor),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _char4=_step2.value;!/[\w\s]/.test(_char4)||_char4 in CHARSET_2||(CHARSET_2[_char4]=[_expression,index=_constructor.indexOf(_char4)])}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}for(var _i3=0,_Object$entries3=Object.entries(CHARSET_2);_i3<_Object$entries3.length;_i3++){var value=_Object$entries3[_i3],_value=(0,_slicedToArray2.default)(value,2),_char5=_value[0],_value$=(0,_slicedToArray2.default)(_value[1],2),_expression2=_value$[0],_index=_value$[1],expansion="`${".concat(_expression2,"[").concat(GLOBAL_VAR,".$]}`[").concat("".concat(_index).split(_templateObject7=_templateObject7||(0,_taggedTemplateLiteral2.default)([""])).map(function(e){return"".concat(GLOBAL_VAR,".").concat(encodeDigit(e))}).join(_templateObject6=_templateObject6||(0,_taggedTemplateLiteral2.default)(["+"])),"]");_char5 in CHARSET_1||(CHARSET_2[_char5]=[_expression2,_index,expansion])}var objectDifference=function(t,e){return Object.fromEntries(_lodash.default.difference(_lodash.default.keys(t),_lodash.default.keys(e)).map(function(e){return[e,t[e]]}))},CHARSET_2_DIFF=objectDifference(CHARSET_2,CHARSET_1),RES_CHARSET_2="".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+Object.entries(CHARSET_2_DIFF).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=(0,_slicedToArray2.default)(e[1],3)[2];return"".concat(quote(encodeLetter(t)),":").concat(e)})+"}",encodeString=function(){return(0,_toConsumableArray2.default)("".concat(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").replace(/\W/g,"")).map(function(e){return/[$_]/.test(e)?quote(e):/\d/.test(e)?"".concat(GLOBAL_VAR,".").concat(encodeDigit(e)):(e=encodeLetter(e),(0,_isValidIdentifier.default)(e)?"".concat(GLOBAL_VAR,".").concat(e):"".concat(GLOBAL_VAR,"[").concat(quote(e),"]"))}).join(_templateObject8=_templateObject8||(0,_taggedTemplateLiteral2.default)(["+"]))},encodeIdentifiers=function(e){return"".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+Object.entries(e).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0];return[e[1],encodeString(t)]}).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=e[1];return"".concat((0,_isValidIdentifier.default)(t)?t:quote(t),":").concat(e)})+"}"},IDENT_SET2=(RESULT+=";"+encodeIdentifiers(IDENT_SET1),RESULT+=";"+RES_CHARSET_2,{name:"?",map:"^",replace:":",repeat:"*",split:"|",indexOf:"#",source:"`"}),GLOBAL_FUNC=(RESULT+=";"+encodeIdentifiers(IDENT_SET2),{eval:"=",escape:">",unescape:"<",parseInt:"~"}),RES_FUNCTIONS_1="".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+Object.entries(GLOBAL_FUNC).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=e[1];return"".concat(quote(e),":")+"(()=>{})"+"[".concat(GLOBAL_VAR,".$]")+"("+"".concat(GLOBAL_VAR,"._+").concat(GLOBAL_VAR,"[").concat(quote("-"),"]+").concat(encodeString(t))+")()"})+"}",CIPHER_FROM=(RESULT+=";"+RES_FUNCTIONS_1,RESULT+=";"+"".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+[[quote("'"),"".concat(encodeString("to"),"+")+"".concat(quote(""),"[").concat(GLOBAL_VAR,".$]")+"[".concat(GLOBAL_VAR,"[").concat(quote("?"),"]]")],[quote(encodeLetter("C")),"".concat(GLOBAL_VAR,"[").concat(quote(">"),"]")+"(".concat(quote("<"),")")+"[".concat(GLOBAL_VAR,".").concat(encodeDigit(2),"]")],[quote(encodeLetter("D")),"".concat(GLOBAL_VAR,"[").concat(quote(">"),"]")+"(".concat(quote("="),")")+"[".concat(GLOBAL_VAR,".").concat(encodeDigit(2),"]")]].map(function(e){return e.join(_templateObject9=_templateObject9||(0,_taggedTemplateLiteral2.default)([":"]))})+"}","0123456789abcdefghijklmnopqrstuvwxyz"),IDENT_SET3=(RESULT+=";"+"".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+[[quote(encodeLetter("U")),"`${{}[".concat(GLOBAL_VAR,"[").concat(quote("'"),"]]")+"[".concat(GLOBAL_VAR,"[").concat(quote("!"),"]]()}`")+"[".concat(GLOBAL_VAR,".").concat(encodeDigit(8),"]")]].concat((0,_toConsumableArray2.default)((0,_toConsumableArray2.default)("hkqwz").map(function(e){return[quote(encodeLetter(e)),"(+(".concat(encodeString(CIPHER_FROM.indexOf(e)),"))")+"[".concat(GLOBAL_VAR,"[").concat(quote("'"),"]](").concat(encodeString(36),")")]}))).map(function(e){return e.join(_templateObject10=_templateObject10||(0,_taggedTemplateLiteral2.default)([":"]))})+"}",{fromCharCode:"@",keys:"&",toUpperCase:'"'}),CIPHER_TO=(RESULT+=";"+encodeIdentifiers(IDENT_SET3),"_.:;!?*+^-=<>~'\"/|#$%&@{}()[]`\\"),IDENT_SET=_objectSpread(_objectSpread(_objectSpread({},IDENT_SET1),IDENT_SET2),IDENT_SET3),base31=function(r){return"".concat((0,_toConsumableArray2.default)(Array(r.length)).map(function(e,t){return(0,_toConsumableArray2.default)(r.charCodeAt(t).toString(31)).map(function(e){return CIPHER_TO[CIPHER_FROM.indexOf(e)]}).join(_templateObject11=_templateObject11||(0,_taggedTemplateLiteral2.default)([""]))}))},base31Decode=function(e){return String.fromCharCode.apply(String,(0,_toConsumableArray2.default)(e.split(_templateObject12=_templateObject12||(0,_taggedTemplateLiteral2.default)([","])).map(function(e){return parseInt((0,_toConsumableArray2.default)(e).map(function(e){return CIPHER_FROM[CIPHER_TO.indexOf(e)]}).join(_templateObject13=_templateObject13||(0,_taggedTemplateLiteral2.default)([""])),31)})))},ENCODING_MACRO="a=>a.split`,`.map(a=>parseInt([...a].map(a=>[...Array(+(31)).keys()].map(a=>a.toString(31))[CIPHER_TO.indexOf(a)]).join``,31)).map(a=>String.fromCharCode(a)).join``".replace("CIPHER_TO",quote(CIPHER_TO)).replace(/\.toString\b/g,function(e){return"[".concat(GLOBAL_VAR,"[").concat(quote("'"),"]]")}).replace("Array","[][".concat(GLOBAL_VAR,".$]")).replace("String","".concat(quote(""),"[").concat(GLOBAL_VAR,".$]")).replace(/\b\d+\b/g,function(e){return encodeString(e)}).replace("parseInt","".concat(GLOBAL_VAR,"[").concat(quote("~"),"]")).replace(/\ba\b/g,"_"+GLOBAL_VAR).replace(/\.\b(keys|split|map|indexOf|join|fromCharCode)\b/g,function(e){return"[".concat(GLOBAL_VAR,"[").concat(quote(IDENT_SET[e.slice(1)]),"]]")}),RE_CONSTANTS=(RESULT+=";"+"".concat(GLOBAL_VAR,"[+![]]=").concat(ENCODING_MACRO),["true","false","Infinity","NaN","undefined",Object.keys(IDENT_SET)].flat()),keyGen=_regenerator.default.mark(function e(){var t,r,a,n,c;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=".,:;!?*+^-=<>~'\"`/|\\#%&@()[]{}",r="0123456789abcdefghijklmnopqrstuvwxyz",a=_createForOfIteratorHelper("()[]{}"),e.prev=2,a.s();case 4:if((n=a.n()).done){e.next=10;break}return n=n.value,e.next=8,n;case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),a.e(e.t0);case 15:return e.prev=15,a.f(),e.finish(15);case 18:c=0;case 19:if(c<=Number.MAX_SAFE_INTEGER)return e.next=22,c.toString(t.length).padStart(2,0).split(_templateObject14=_templateObject14||(0,_taggedTemplateLiteral2.default)([""])).map(function(e){return t[r.indexOf(e)]}).join(_templateObject15=_templateObject15||(0,_taggedTemplateLiteral2.default)([""]));e.next=25;break;case 22:c++,e.next=19;break;case 25:case"end":return e.stop()}},e,null,[[2,12,15,18]])})(),WORD_LIST=(_ref26=null!=(_TEXT$match=TEXT.match(REGEXPS.word))?_TEXT$match:[],_ref25=Object.entries(_lodash.default.countBy(_ref26)).filter(function(e){e=(0,_slicedToArray2.default)(e,1)[0];return!Object.keys(IDENT_SET).includes(e)}).sort(function(e,t){e=(0,_slicedToArray2.default)(e,2)[1];return(0,_slicedToArray2.default)(t,2)[1]-e}).map(function(e){return[(0,_slicedToArray2.default)(e,1)[0],keyGen.next().value]}),Object.fromEntries(_ref25)),EXPRESSION=(RESULT+=";"+"".concat(GLOBAL_VAR,"={...").concat(GLOBAL_VAR,",")+Object.entries(WORD_LIST).map(function(e){var e=(0,_slicedToArray2.default)(e,2),t=e[0],e=e[1];return"".concat(quote(e),":").concat(GLOBAL_VAR,"[+![]](").concat(quote(base31(t)),")")})+"}","[".concat(TEXT.split(_templateObject16=_templateObject16||(0,_taggedTemplateLiteral2.default)([" "])).map(function(e){return(0,_toConsumableArray2.default)(e.matchAll(REGEXP)).map(function(e){var e=(0,_slicedToArray2.default)(Object.entries(e.groups).filter(function(e){return null!=(0,_slicedToArray2.default)(e,2)[1]})[0],2),t=e[0],r=e[1];switch(t){case"constant":return"`${".concat(CONSTANTS[r],"}`");case"constructor":return"".concat(CONSTRUCTORS[r],"[").concat(GLOBAL_VAR,".$][").concat(GLOBAL_VAR,"[").concat(quote("?"),"]]");case"letter":return encodeString(r);case"word":var a=WORD_LIST[r];return"string"==typeof IDENT_SET[r]&&(a=IDENT_SET[r]),"".concat(GLOBAL_VAR,"[").concat(quote(a),"]");case"unicode":a=base31(r);return"".concat(GLOBAL_VAR,"[+![]](").concat(quote(a),")");default:return quote(r)}}).join(_templateObject17=_templateObject17||(0,_taggedTemplateLiteral2.default)(["+"]))}),"][").concat(GLOBAL_VAR,"[").concat(quote("%"),"]](").concat(GLOBAL_VAR,"[").concat(quote("-"),"])"));return RESULT+=";"+"_".concat(GLOBAL_VAR,"=").concat(EXPRESSION),RESULT+=";module"+"[".concat(quote("exports"),"]")+"[".concat(quote("result"),"]=_")+GLOBAL_VAR,{result:RESULT,stats:"=====\nSTATS\n=====\nInput length: ".concat(enUS.format(TEXT.length),"\nExpression length: ").concat(enUS.format(EXPRESSION.length),"\nRatio: ").concat(EXPRESSION.length/TEXT.length,"\nOutput length: ").concat(enUS.format(RESULT.length))}}var _encodeText=encodeText(text,"_",{STRICT_MODE:!0,QUOTE_STYLE:"single"}),result=_encodeText.result,stats=_encodeText.stats;print(stats),_fs.default.writeFileSync("./output.js",result);